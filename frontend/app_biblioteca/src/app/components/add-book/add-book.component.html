<!-- Modal -->
<div class="modal fade" id="createBook" data-bs-backdrop="static" tabindex="-1" aria-labelledby="newBook" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-light-purple text-white">
        <h1 class="modal-title fs-5" id="newBook">Nuevo Libro</h1>
        <button type="button" class="btn-close text-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="bookForm" (ngSubmit)="save()">
          <!-- Título -->
          <input 
            formControlName="title"
            class="form-control mb-2"
            placeholder="Título del libro"
            [ngClass]="{'is-invalid': bookForm.get('title')?.invalid && bookForm.get('title')?.touched}"
          >
          <div class="invalid-feedback">Campo obligatorio (mínimo 4 caracteres)</div>

          <!-- Editorial -->
          <input 
            formControlName="publisher"
            class="form-control mb-2"
            placeholder="Editorial"
            [ngClass]="{'is-invalid': bookForm.get('publisher')?.invalid && bookForm.get('publisher')?.touched}"
          >
          <div class="invalid-feedback">Campo obligatorio (mínimo 4 caracteres)</div>

          <!-- Autores -->
          <div class="mb-2">

            <div class="input-group">
              <input
                formControlName="author" 
                type="text" class="form-control" 
                placeholder="Buscar autor" 
                aria-label="Buscar autor" 
                aria-describedby="button-addon2"
                (input)="getAuthors()"
                list="authorsList">
              <button  class="btn btn-outline-primary" type="button" id="button-addon2" (click)="addAuthor()">
                <i class="bi bi-plus-circle"></i>
              </button>
            </div>
            
            <datalist id="authorsList">
              <option *ngFor="let author of authors" [value]="author.autor_nombre + ' ' + author.autor_apellido"></option>
            </datalist>
            <ul class="list-group mt-2">
              <li 
                class="list-group-item d-flex justify-content-between align-items-center"
                *ngFor="let author of selectedAuthors"
              >
                {{ author.autor_nombre }} {{ author.autor_apellido }}
                <button type="button" class="btn btn-sm btn-danger" (click)="removeAuthor(author)">
                  <i class="bi bi-trash"></i>
                </button>
              </li>
            </ul>
          </div>

          <!-- Género -->
          <select 
            formControlName="gender"
            class="form-select mb-3"
          >
            <option value="">Seleccionar género...</option>
            <option *ngFor="let gender of genders" [value]="gender">{{ gender }}</option>
          </select>

          <!-- Botones -->
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="submit" class="btn btn-success" [disabled]="bookForm.invalid">Crear</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Botón flotante -->
<div class="fixed-bottom text-end mb-3 me-3">
  <button class="btn btn-info text-white" data-bs-toggle="modal" data-bs-target="#createBook">
    <i class="bi bi-plus-circle-fill fs-3"></i>
  </button>
</div>
